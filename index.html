<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NAP'S Restaurant Offline POS</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#e63946">
<style>
body{font-family:Arial;margin:0;background:#f4f4f4}
header{background:#e63946;color:#fff;padding:15px;text-align:center;font-size:22px}
nav{display:flex;background:#333}
nav button{flex:1;padding:14px;border:none;background:#333;color:#fff;font-size:16px}
.page{display:none;padding:15px}
.active{display:block}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.card{background:#fff;padding:20px;border-radius:12px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,.2);font-size:18px}
button.primary{background:#e63946;color:#fff;border:none;padding:12px;border-radius:8px;font-size:16px;margin-top:8px}
input{width:100%;padding:10px;margin:6px 0;font-size:16px}
.orderCard{background:#fff;padding:12px;margin:8px;border-radius:10px}
.badge{padding:3px 8px;border-radius:6px;color:#fff;font-size:12px}
.pending{background:#f4a261}
.paid{background:#2a9d8f}
.bigBtn{width:48%;padding:15px;font-size:18px;margin:1%}
#installBtn{position:fixed;bottom:15px;right:15px;padding:15px;border:none;border-radius:50%;background:#e63946;color:#fff;font-size:20px}
</style>
</head>
<body>
<header>NAP'S Restaurant POS</header>
<nav>
<button onclick="showPage('pos')">POS</button>
<button onclick="showPage('orders')">Orders</button>
<button onclick="showPage('sales')">Sales</button>
</nav>

<!-- POS -->
<div id="pos" class="page active">
<h2>Menu</h2>
<div class="grid" id="menu"></div>
<h2>Cart</h2>
<div id="cart"></div>
<h3>Total â‚±<span id="total">0</span></h3>

<h3>Payment</h3>
<button class="bigBtn" onclick="pay('Cash')">ðŸ’µ Cash</button>
<button class="bigBtn" onclick="pay('GCash')">ðŸ“± GCash</button>

<div id="gcashBox" style="display:none">
<p>Receive payment then upload proof</p>
<input type="file" id="proof" accept="image/*">
<button class="primary" onclick="confirmGCash()">Confirm GCash</button>
</div>
</div>

<!-- ORDERS -->
<div id="orders" class="page">
<h2>Orders</h2>
<div id="orderList"></div>
</div>

<!-- SALES -->
<div id="sales" class="page">
<h2>Today's Sales</h2>
<h1>â‚±<span id="salesTotal">0</span></h1>
<button class="primary" onclick="closeDay()">Close Day</button>
</div>

<button id="installBtn">ðŸ“±</button>

<script>
const products=[
{name:'Burger',price:120},
{name:'Fries',price:70},
{name:'Chicken',price:150},
{name:'Spaghetti',price:130}
];

let cart=[];
let pendingGCash=false;

function showPage(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');renderOrders();renderSales();}

function renderMenu(){
menu.innerHTML='';
products.forEach((p,i)=>{
menu.innerHTML+=`<div class='card' onclick='add(${i})'>${p.name}<br>â‚±${p.price}</div>`;
});}

function add(i){let item=cart.find(c=>c.name===products[i].name);if(item)item.qty++;else cart.push({...products[i],qty:1});renderCart();}

function renderCart(){cart.innerHTML='';let t=0;cart.forEach(c=>{t+=c.price*c.qty;cart.innerHTML+=`<div>${c.name} x${c.qty}</div>`});total.innerText=t}

function pay(type){if(!cart.length)return alert('Empty cart');
if(type==='Cash')completeOrder('Cash',null);
else{pendingGCash=true;gcashBox.style.display='block';}}

function confirmGCash(){if(!proof.files.length)return alert('Upload proof');let r=new FileReader();r.onload=e=>completeOrder('GCash',e.target.result);r.readAsDataURL(proof.files[0]);}

function completeOrder(payment,proofImg){let orders=JSON.parse(localStorage.getItem('orders')||'[]');let sales=JSON.parse(localStorage.getItem('sales')||'0');
let totalVal=Number(total.innerText);
orders.push({id:Date.now(),items:cart,total:totalVal,payment,proof:proofImg,status:'Done',paymentStatus:'Paid'});
localStorage.setItem('orders',JSON.stringify(orders));
sales+=totalVal;localStorage.setItem('sales',JSON.stringify(sales));
printReceipt(orders[orders.length-1]);
cart=[];renderCart();gcashBox.style.display='none';alert('Order saved');}

function renderOrders(){let orders=JSON.parse(localStorage.getItem('orders')||'[]');orderList.innerHTML='';orders.slice().reverse().forEach(o=>{orderList.innerHTML+=`<div class='orderCard'>#${o.id}<br>â‚±${o.total} ${o.payment}</div>`});}

function renderSales(){salesTotal.innerText=JSON.parse(localStorage.getItem('sales')||'0');}

function closeDay(){if(!confirm('Close day?'))return;localStorage.setItem('orders','[]');localStorage.setItem('sales','0');renderOrders();renderSales();}

function printReceipt(o){let w=window.open('','','width=300');w.document.write(`<body style='font-family:monospace;width:260px'>NAP'S Restaurant<hr>${o.items.map(i=>i.name+' x'+i.qty+' '+i.price*i.qty).join('<br>')}<hr>Total â‚±${o.total}<br>${o.payment}<hr>Thank you</body>`);w.print();w.close();}

renderMenu();

// PWA install
let deferredPrompt;window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e});installBtn.onclick=()=>{if(deferredPrompt)deferredPrompt.prompt()};

// service worker
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}
</script>
</body>
</html>
