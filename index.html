<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NAP'S Restaurant</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<!-- NAVBAR -->
<div class="bg-white shadow p-4 flex justify-between">
  <h1 class="font-bold text-xl">NAP'S Restaurant</h1>
  <div class="space-x-2">
    <button onclick="showPage('home')" class="px-3 py-1 bg-blue-500 text-white rounded">Home</button>
    <button onclick="showPage('menu')" class="px-3 py-1 bg-blue-500 text-white rounded">Menu</button>
    <button onclick="showPage('cart')" class="px-3 py-1 bg-blue-500 text-white rounded">Cart (<span id="cartCount">0</span>)</button>
    <button onclick="showPage('admin')" class="px-3 py-1 bg-gray-700 text-white rounded">Admin</button>
  </div>
</div>

<!-- HOME -->
<div id="home" class="p-8 text-center">
  <h2 class="text-3xl font-bold mb-4">Welcome to NAP'S Restaurant</h2>
  <p>Order your favorite Filipino meals online</p>
  <button onclick="showPage('menu')" class="mt-4 px-6 py-2 bg-green-500 text-white rounded">Order Now</button>
</div>

<!-- MENU -->
<div id="menu" class="hidden p-8 grid md:grid-cols-2 gap-4">
</div>

<!-- CART -->
<div id="cart" class="hidden p-8 max-w-xl mx-auto">
  <h2 class="text-2xl font-bold mb-2">Your Cart</h2>
  <div id="cartItems"></div>
  <h3 class="font-bold mt-2">Total: ₱<span id="total">0</span></h3>

  <input id="phone" class="w-full border p-2 mt-3 rounded" placeholder="Phone number" />
  <textarea id="address" class="w-full border p-2 mt-3 rounded" placeholder="Delivery address"></textarea>

  <div class="mt-3 space-x-2">
    <button onclick="selectPayment('GCash')" id="gcashBtn" class="px-3 py-1 border rounded">GCash</button>
    <button onclick="selectPayment('COD')" id="codBtn" class="px-3 py-1 border rounded">Cash on Delivery</button>
  </div>

  <button onclick="placeOrder()" class="mt-4 w-full bg-green-500 text-white p-2 rounded">Place Order</button>
</div>

<!-- RECEIPT -->
<div id="receipt" class="hidden p-8 max-w-xl mx-auto"></div>

<!-- ADMIN -->
<div id="admin" class="hidden p-8 max-w-xl mx-auto">
  <h2 class="text-xl font-bold mb-3">Admin Panel</h2>
  <div id="adminContent">No order</div>
</div>

<script>
/* ==============================
   CONFIGURATION (EDIT THESE)
================================*/

// ⭐ Example Philippine SMS API (Semaphore / Twilio etc)
const SMS_API_URL = "https://api.semaphore.co/api/v4/messages"; // example
const SMS_API_KEY = "YOUR_SMS_API_KEY"; // put real key

// ⭐ GCash mock payment link (replace with real PayMongo / Xendit link)
const GCASH_PAYMENT_LINK = "https://paymongo.link/YOUR_LINK";

/* ==============================
   DATA
================================*/

let foods=[
{id:1,name:"Chicken Inasal",price:120},
{id:2,name:"Pork Sisig",price:150},
{id:3,name:"Beef Tapa",price:140},
{id:4,name:"Halo-Halo",price:90}
];

let cart=[];
let orders=[]; // ⭐ MULTI ORDER DATABASE
let payment=null;
let activeOrder=null;
let status="Preparing";

/* ==============================
   MENU RENDER
================================*/
const menuDiv=document.getElementById('menu');
foods.forEach(f=>{
menuDiv.innerHTML+=`<div class='bg-white p-4 rounded shadow flex justify-between'>
<div>${f.name}<br>₱${f.price}</div>
<button onclick='addToCart(${f.id})' class='bg-blue-500 text-white px-3 rounded'>Add</button></div>`;
});

function showPage(p){
['home','menu','cart','receipt','admin'].forEach(id=>document.getElementById(id).classList.add('hidden'));
document.getElementById(p).classList.remove('hidden');
}

function addToCart(id){
const item=foods.find(f=>f.id===id);
cart.push(item);
document.getElementById('cartCount').innerText=cart.length;
renderCart();
}

function renderCart(){
let div=document.getElementById('cartItems');
div.innerHTML='';
let total=0;
cart.forEach(i=>{div.innerHTML+=`${i.name} - ₱${i.price}<br>`; total+=i.price});
document.getElementById('total').innerText=total;
}

function selectPayment(p){
payment=p;
gcashBtn.classList.remove('bg-green-400');
codBtn.classList.remove('bg-green-400');
if(p==='GCash') gcashBtn.classList.add('bg-green-400');
else codBtn.classList.add('bg-green-400');
}

/* ==============================
   SMS SENDING
================================*/
async function sendSMS(phone,message){
try{
await fetch(SMS_API_URL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({apikey:SMS_API_KEY,number:phone,message})
});
}catch(e){console.log("SMS failed",e)}
}

/* ==============================
   ORDER FLOW
================================*/
function placeOrder(){
const phone=document.getElementById('phone').value;
const address=document.getElementById('address').value;
const total=document.getElementById('total').innerText;
if(!phone||!address||!payment){alert('Fill all fields');return}

activeOrder={
id:Date.now(),phone,address,payment,total,items:[...cart],status:"Preparing"};
orders.push(activeOrder);

if(payment==='GCash'){
window.open(GCASH_PAYMENT_LINK,'_blank');
}

sendSMS(phone,`NAP'S Restaurant: Order received. Preparing.`);

cart=[];
renderCart();
document.getElementById('cartCount').innerText=0;
showReceipt();
renderAdmin();
}

/* ==============================
   RECEIPT
================================*/
function showReceipt(){
showPage('receipt');
receipt.innerHTML=`<div class='bg-white p-4 rounded shadow'>
<h2 class='font-bold text-xl'>Receipt</h2>
Phone: ${activeOrder.phone}<br>
Address: ${activeOrder.address}<br>
Payment: ${activeOrder.payment}<br>
Total: ₱${activeOrder.total}<br>
<div class='mt-2 bg-green-100 p-2 rounded'>SMS confirmation sent</div>
<div class='mt-2'>Status: <span id='statusTxt'>${activeOrder.status}</span></div>
<button onclick="showPage('home')" class='mt-3 bg-blue-500 text-white px-3 rounded'>Home</button>
</div>`;
}

/* ==============================
   ADMIN DASHBOARD (MULTI ORDER)
================================*/
function renderAdmin(){
if(!orders.length){adminContent.innerHTML='No orders';return}

adminContent.innerHTML='';
orders.forEach(o=>{
adminContent.innerHTML+=`<div class='bg-white p-3 mb-2 rounded shadow'>
<b>${o.phone}</b><br>
Total ₱${o.total}<br>
Status: ${o.status}<br>
<button onclick="updateStatus(${o.id},'Preparing')" class='bg-blue-300 px-2'>Preparing</button>
<button onclick="updateStatus(${o.id},'Out for delivery')" class='bg-yellow-300 px-2'>Out</button>
<button onclick="updateStatus(${o.id},'Delivered')" class='bg-green-300 px-2'>Done</button>
</div>`;
});
}

function updateStatus(id,s){
const o=orders.find(x=>x.id===id);
o.status=s;
activeOrder=o;
if(document.getElementById('statusTxt')) document.getElementById('statusTxt').innerText=s;
sendSMS(o.phone,`NAP'S Restaurant: Your order is now ${s}`);
renderAdmin();
}

</script>

</body>
</html>
